<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
  </head>
  <body>
    <div><%- include('./partials/navbar.ejs'); %></div>
    <div><%- include('./partials/data-table.ejs'); %></div>
    <% if (currentUser) { %>
    <div><%- include('./partials/sidebar.ejs') %></div>
    <% }; %>
    <aside><%- include('./partials/tree.ejs', {folders: folders}); %></aside>

    <h1>Home</h1>

    <div>
      <div>Name</div>
      <div>Last Modified</div>
      <div>File Size</div>
    </div>

    <!-- File Info Component -->
    <dialog id="file-info-drawer">
      <h4>File Info</h4>
      <div class="drawer-content"></div>
      <button class="close-drawer">Close</button>
      <button>Share</button>
      <form action="/file/delete">
        <button>Delete</button>
      </form>
      <button>Download</button>
    </dialog>

    <el-dialog>
      <dialog
        id="drawer"
        aria-labelledby="drawer-title"
        class="fixed inset-0 size-auto max-h-none max-w-none overflow-hidden bg-transparent not-open:hidden backdrop:bg-transparent"
      >
        <el-dialog-backdrop
          class="absolute inset-0 bg-gray-900/50 transition-opacity duration-500 ease-in-out data-closed:opacity-0"
        ></el-dialog-backdrop>

        <div tabindex="0" class="absolute inset-0 pl-10 focus:outline-none sm:pl-16">
          <el-dialog-panel
            class="group/dialog-panel relative ml-auto block size-full max-w-md transform transition duration-500 ease-in-out data-closed:translate-x-full sm:duration-700"
          >
            <!-- Close button, show/hide based on slide-over state. -->
            <div
              class="absolute top-0 left-0 -ml-8 flex pt-4 pr-2 duration-500 ease-in-out group-data-closed/dialog-panel:opacity-0 sm:-ml-10 sm:pr-4"
            >
              <button
                type="button"
                command="close"
                commandfor="drawer"
                class="relative rounded-md text-gray-400 hover:text-white focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500"
              >
                <span class="absolute -inset-2.5"></span>
                <span class="sr-only">Close panel</span>
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  data-slot="icon"
                  aria-hidden="true"
                  class="size-6"
                >
                  <path d="M6 18 18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </button>
            </div>

            <div
              class="relative flex h-full flex-col overflow-y-auto bg-gray-800 py-6 shadow-xl after:absolute after:inset-y-0 after:left-0 after:w-px after:bg-white/10"
            >
              <div class="px-4 sm:px-6">
                <h2 id="drawer-title" class="text-base font-semibold text-white">Panel title</h2>
              </div>
              <div class="relative mt-6 flex-1 px-4 sm:px-6">
                <!-- Your content -->
              </div>
            </div>
          </el-dialog-panel>
        </div>
      </dialog>
    </el-dialog>

    <!-- new Folder Component -->
    <dialog id="newFolderModal">
      <div>
        <p>New Folder</p>
        <button id="newFolderModalCloseBtn" type="reset">x</button>
      </div>
      <form action="/folders" method="POST">
        <div>
          <input type="text" id="newFolderName" name="newFolderName" />
          <input type="hidden" name="parentFolderId" value="<%= parentFolderId || null %>" />
        </div>
        <div>
          <button type="submit">Create</button>
        </div>
      </form>
    </dialog>

    <!-- New File Component -->
    <dialog id="newFileModal">
      <div>
        <p>New File</p>
        <button id="newFileModalCloseBtn" type="reset">x</button>
      </div>
      <form action="/file" method="POST" enctype="multipart/form-data">
        <div>
          <input type="file" name="uploaded_file" />
          <input type="hidden" name="parentFolderId" value="<%= parentFolderId %>" />
        </div>
        <div>
          <button type="submit">Upload</button>
        </div>
      </form>
    </dialog>

    <dialog id="deleteFolderModal">
      <div>
        <p id="deleteMessage"></p>
        <form action='/folder/:folder.id_method="DELETE"' method="POST" id="deleteFolderForm">
          <input type="hidden" name="folderId" id="deleteFolderIdInput" />
          <button type="reset" id="deleteFolderModalCloseBtn">Cancel</button>
          <button type="submit" id="deleteFolderBtn">Delete</button>
        </form>
      </div>
    </dialog>

    <dialog id="editFolderModal">
      <div>
        <p id="editMessage"></p>
        <form action="/folder/:folder.id_method='PUT'" method="POST" id="editFolderForm">
          <input type="hidden" name="folderId" id="editFolderIdInput" />
          <input type="text" name="folderName" id="editFolderNameInput" value="folderName" />
          <button type="reset" id="editFolderModalCloseBtn">Cancel</button>
          <button type="submit" id="editFolderBtn">Save</button>
        </form>
      </div>
    </dialog>

    <script type="module" src="../folders/deleteFolder.js"></script>
    <script type="module" src="../folders/editFolder.js"></script>
    <script type="module" src="../folders/createNewFolder.js"></script>
    <script type="module" src="../files/fileInfoDrawer.js"></script>
  </body>
</html>
